---
title: "Smoking will Further Downregulate the SFTPC Expression which Increase the Risk of NSCLC"
author: "Maggie Chen"
date: "November 21, 2018"
output: github_document
bibliography: references.bib
csl: bioinformatics.csl
---

*Overall, a single-spaced page is about 500 words. So if the guidelines say half of a page, think about writing around 250 words. You can use the wordcountaddin in RStudio to track your progress.*

# Introduction
Lung cancer is the most deadly cancer for both men and women in US, which had exceeded the death rate combination of three most common cancer that is colon, breast and pancreatic cancer [@siegel2014cancer]. There are two main sub-type of lung cancer, small cell lung cancer and non-small cell lung cancer (NSCLC). NSCLC accounts for 85% of all lung cancers. NSCLC is further classified into three types, squamous-cell carcinoma, carcinoma and large-cell carcinoma [@molina2008non]. Adenocarcinoma arise from typeII alveolar cell that forms the small airways. Adenocarcinoma is also the most common lung cancer found in both smoking and non-smoking population which accounts 30-40% of lung cancer regardless of gender and age [@couraud2012lung]. Smoking is the most prevalent risk factor for lung cancer in both male and female population. The length of smoking time and the amount of ciggrattes people smoked is positivly corrolated to the risk of lung cancer [@powell2013association]. Further sutudy has also indicated the differences between smokers and nonsmoker's pathogenetic mechanisms in lung cancer. For example, in adenocarcinoma there is a distinct new molecular pathway in smoker's lung cancer developmet than non-smokers. What's more, those smoking related genomic signiture in NSCLC can help predict the cancer with 74% of accuracy [@massion2008smoking].
Nowadays, along with the improvement of sequencing techniques, RNA-Seq has become a sufficient method use the deep sequencing technology to profile transcriptome. RNA-Seq has provide a new view of eukaryotic transcriptome complexity. RNA-Seq also enable a percise measurment of levels of transcripts and isoforms [cite].
Li et al. has found several genes are either downregulated or upregulated in lung cancer tissues(cite) using the data set from Seo et al.. I was primarly interested in the questions of how lung cancer will impact the lung function and the expression levels of the genes that support lung functions in addition to genes identified by Li et al. Thus, in the paper, I mainly fouced on investigate what is impact of smoking on genes that is highly expressed in normal tissue, but downregulated in cancer tissues. Also, whther there is a corrolation between smoking, age and gender on the gene expression level. I have found SFTPC gene is higly downregulated in cancer tissues, which encodes the plumnary-associated surfacant protein C (SPC). SPC is exclusively produced by type II alveolar cells, which prevents lung collapse by lowering the surface tension at air-liqud surface in the lung [@clark2005genetics]. What's more, smoking will cause the further downregulation of SFTPC gene along with the increase of age. However, for previous and never smoker, there is no significan corrolation between age and SFPTC gene expression levels. 

# Methods

## Sample origin and sequencing

Add about half a page here. In this section instead of first person (I/we), use Li et al. [@li2015rna] and Seo et al. [@seo2012transcriptional], since you'll just be describing what they did, based on the methods in their paper(s). It's important to include this so the reader knows what the study design was for the data you will be presenting.

## Computational

These are the methods that were used to process the sequencing data. Should probably be at least a half of a page. At a very minimum should include citations for biomartr, trimmomatic, and sailfish. Note that these three methods references don't count towards the five references you need to cite in the introduction.

# Results

First of all, to investiagte the critial genes that maintain the healthy lung function. I listed out the top fifteen most highly expressed genes in never smokers' normal tissues (Table1). The expression levels is measued as the mean count of normalized expression count, and then catagrized in cancer stages stages. As shown in the table, for never smmokers that has stage 3A lung cancer, in their normal tissue the SFTPC gene has the highest expression level across all samples, then SFTPA2 gene in satge 3A never smokers, and then the EEF1A1 gene in stage 3B never smokers is also relativly highly expressed. Each sample is recognized as a independent individal, and grouped into cancer stages whcih creates some repeated genes in the table. What's more, for individuals listed in Table1, most of them are in cancer stage 3, which is the relative later and sever stages. Then extract the unique genes from the Table1, that is SFTPC, SFTPA1, SFTPA2, EEF1A1, and SFTPB gene, to examine their expression levels in different tissue type, normal or cancer, and different cancer stages. As the result, all five genes are highly expressed in the normal tissues, but they have different average expression levels in cancer tissues, and in different cancer stages. EEF1A1 gene is relatively highly expressed in the cancer tissue with minimal downregulation, mostly on stage 3B and 4. SFTPA1, SFTPA2, and SFTPC are more down-regulated in cancer tissues, in almost all cancer stages. SFTPA1 and SFTPA2 gene expression are relativly down-regulated in stages other 2B. SFTPB gene is mostly downregulated in stage 3B and stage 4. SFTPC is mostly down regulated throughout all cancer stages. As SFTPC gene is mostly down regulated in cancer tissues, more importantly throughout all cancer stages. 
Next, I specifically focused on how SFTPC gene expression levels is impaced by smoking. Overall, all cancer tissues has SFTPC gene significantly down regulated. Specifically, for current and previous smokers' cancer tissues there is a irregular, but mostly more down regulation than never smokers with some out-liers. For example, the 1B stage for the current smokers and the 3A stage for the previously smokers. In contrast, in never smokers' cancer tissues, the SFTPC has showed some persistent to the down regulation in all cancer stages, especially later stages. In addition, in the normal tissues, current smoker has a lower SFTPC gene average expression levels than never and previous smokers. After observing current smoking status will impact the SFTPC gene expression levels with some irregular pattern, then I further include the age at diagnosis as a variable to investigate how smoking will impact the SFTPC gene expression along with age at diagnosis in both normal and cancer tissues. SFTPC gene is highly down regulated in the cancer tissues, which has gene mean expression levels close to zero. For previous and current smokers' cancer tissues, SFTPC gene expression is closer to zero than never smokers and not change along with age change in the cancer tissue. In the cancer tissue from never smokers, the SFTPC expression level remains low, but there is a slight increase with age increase due to two outliers at age of 65, otherwise, there is a small corrolation with age at diagnosis. In contrast, SFTPC gene is significantly highly expressed in normal tissues. Also, along with the smoking status of individuals, in normal tissues, for never smoker, the gene expression levels slightly decrease along with the increase of age, which is in-significant. For normal tissues from current smokers, the gene expression is significantly decreased, while age increases. For normal tissue from previous smoker, the gene expression level increase not significantly, while age increases. Knowing current smoking status will decrease SFTPC expression in normal tissues along with age at diagnosis, I was curious about how gender will associate with it. 
Thus, lastly I examined the relationship between the average SFTPC gene expression levels, gender and smoking status. As the result, comparing the SFTPC gene expression levels in male and female independently, cancer tissues has SFTPC gene significanlty down regulated than normal tissues. Compare accross male and female cancer tissue samples, female has SFTPC expressed slighltly more than males cancer tissues. In camparision of tissue types, female samples are dominated by never smokers with a few previous smokers' samples. Male samples are abundant in previous smokers and current smokers, with very small sample amout of never smokers. Thus, for female never smokers the SFTPC expression levels is not changed significaltly along with age at diagnosis. For male current smoker, SFTPC mean expression levels decrease significantly while age at diagnosis increases. For male previous smokers, age at diagnosis is does not influence the SFTPC expression levels. 
 

```{r load-libraries, message = FALSE, echo = FALSE}
# Be sure to install these packages before running this script
# They can be installed either with the intall.packages() function
# or with the 'Packages' pane in RStudio

# load general-use packages
library("dplyr")
library("tidyr")
library("knitr")
library("ggplot2")
library("magrittr")

# this package allows for the easy inclusion of literature citations in our Rmd
# more info here: https://github.com/crsh/citr
# and here:
# http://rmarkdown.rstudio.com/authoring_bibliographies_and_citations.html
library("citr")
```

```{r load-data, message = FALSE, echo = FALSE}
# load the dataset from a compressed binary file
# it gets loaded as an object called "joined_table"
# this has 6.2 million rows...so you will need to be thoughtful about
# how you analyze the data so that you don't overwhelm your laptop
load("output/final_compiled_counts/joined_count_data.RData")

# test that it loaded correctly before proceeding
stopifnot(exists("joined_table"))
```

```{r normal-never-table, echo = FALSE}
# Summary table of gene expression levels in the noraml tissue
# also, from never smokers
# The most highly expressed gene is listed in the talbe
top_15 <- joined_table %>%
  filter(normal_or_cancer == "normal") %>%
  filter(smoking_status == "never") %>%
  group_by(genename, cancer_stage) %>%
  summarize(mean_count = mean(counts_lengthscaledtpm)) %>%
  arrange(desc(mean_count)) %>%
  head(n = 15)


# then use the `kable()` function to make a nicely formatted
# markdown table
top_15 %>%
  kable()
```

**Table 1**: Top fifteen genes that is most highly expressed in never smoker's normal tissues.




```{r make-barplot-of-highly-expressed-genes, echo = FALSE}
# Use the higly expressed gene in
# never smoker's normal tissue found above 
# to generate a histogram of how those genes are expressed 
# in both normal and cancer tissue, along with different cancer stages 


# To pull out the unique gene names and turn
# them into a vector then use it below to make a histogram
# use the pull() funtion to get this as a vector
top_genes <- top_15 %>%
  ungroup() %>%
  select(genename) %>%
  unique() %>%
  pull()

# To generate a table use the mean count of gene expression
# also factors of cancer stages and tissue types

joined_table %>%
  filter(genename %in% top_genes) %>%
  filter(cancer_stage != "unknown") %>%
  # exclude samples has unknown stages
  group_by(normal_or_cancer, cancer_stage, genename) %>%
  summarise(mean_count = mean(counts_lengthscaledtpm)) %>%
  ggplot(aes(x = genename,
             y = mean_count,
             fill = cancer_stage)) +
    geom_col(position = "dodge") +
  xlab("Genename") +
  ylab("Mean Expression Level") +
  ggtitle("Gene Expression Levels in Different Cancer Stages") +
  facet_grid(~ normal_or_cancer) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 90,
                         hjust = 1))
```


**Figure 1**: The average gene expression levels in cancer and normal tissues. Categorized by smoking status, and colored by cancer stages. All five genes are highly expressed in the normal tissues, but they have different average expression levels in cancer tissues, and in different cancer stages. EEF1A1 gene is relatively highly expressed in the cancer tissue with minimal downregulation, mostly on stage 3B and 4. SFTPA1, SFTPA2, and SFTPC are more down-regulated in cancer tissues, in almost all cancer stages. SFTPA1 and SFTPA2 gene expression are relativly down-regulated in stages other 2B. SFTPB gene is mostly downregulated in stage 3B and stage 4. SFTPC is mostly down regulated throughout all cancer stages. 

```{r barplot-of-SFTPC-expression-levels-smoking-cancer_stage, echo = FALSE}
# how SFTPC gene is expressed in all individuals(mean count of gene expression)
# samples from patients' both normal and cancer tissues
# along with the expression levels in different 
# cancer stages, and smoking status

joined_table %>%
  filter(genename %in% "SFTPC") %>%
  filter(smoking_status != "unknown") %>%
  filter(cancer_stage != "unknown") %>%
  group_by(normal_or_cancer, cancer_stage, smoking_status) %>%
  summarise(mean_count = mean(counts_lengthscaledtpm)) %>%
  ggplot(aes(x = smoking_status,
             y = mean_count,
             fill = cancer_stage)) +
    geom_col(position = "dodge") +
  xlab("Smoking Status") +
  ylab("Mean Expression Level") +
  ggtitle("SFTPC Expression Levels in Different Cancer and Smoking Status") +
  facet_grid(~ normal_or_cancer) +
   theme_bw() +
   theme(axis.text.x = element_text(angle = 90,
                         hjust = 1))
```

**Figure2**: SFTPC gene expression levels' association with smoking status and different cancer stages, tissue types. Catagroized by smoking status and tissue types, colored by cancer stages. Overall, all cancer tissues has SFTPC gene significantly down regulated. Specifically, for current and previous smokers' cancer tissues there is a irregular, but mostly more down regulation than never smokers with some out-liers. For example, the 1B stage for the current smokers and the 3A stage for the previously smokers. In contrast, in never smokers' cancer tissues, the SFTPC has showed some persistent to the down regulation in all cancer stages, especially later stages. In addition, in the normal tissues, current smoker has a lower SFTPC gene average expression levels than never and previous smokers. 

```{r scatterplot-of-SFTPC-expression-smoking-age, echo = FALSE}
# Examine the average expression levels of SFTPC gene
# only for individals has both normal and cancer 
# tissue sampled, which based on smoking status
# and age at diagnosis

joined_table %>%
  filter(genename == "SFTPC") %>%
  filter(smoking_status != "unknown") %>%
  filter(normal_rnaseq == "yes") %>%
  group_by(normal_or_cancer, smoking_status, age_at_diagnosis) %>%
  summarise(mean_count = mean(counts_lengthscaledtpm)) %>%
  ggplot(aes(x = age_at_diagnosis,
             y = mean_count,
             color = smoking_status)) +
  xlab("Age at Diagnosis") +
  ylab("Mean Expression Level") +
  ggtitle("SFTPC Expression Levels Variants in Age and Smoking Status") +
  geom_point() +
   theme_bw() +
  geom_smooth(method = "lm",
              alpha = 0) +
  facet_grid(~ normal_or_cancer)

```

**Figure3**: SFTPC gene expression levels' association with age at diagnosis and smoking status. Use age at diagnosis as the continuous variable and catagrize into tissues types and colored by smoking status. Overall, SFTPC gene is highly down regulated in the cancer tissues, which has gene mean expression levels close to zero.For previous and current smokers' cancer tissues, SFTPC gene expression is closer to zero than never smokers and not change along with age change in the cancer tissue. In the cancer tissue from never smoker, the SFTPC expression level remains low, but there is a slight increase with age increase due to two outliers at age of 65, otherwise, there is a small corrolation with age at diagnosis. But SFTPC gene is significantly highly expressed in normal tissues. Also, along with the smoking status of individuals, in normal tissues, for never smoker, the gene expression levels slightly decrease along with the increase of age, which is in-significant. For normal tissues from current smokers, the gene expression is significantly decreased, while age increases. For normal tissue from previous smoker, the gene expression level increase not significantly, while age increases. 
 


```{r scaterplot-of-expression-level-of-gender-age-smoking, echo = FALSE}

# Due to Figure2, 3 has different trending of SFTPC gene expression
# in normal tissues, to investigate this different
# this plot shows how in different gender, and smoking status
# will influence the SFTPC genes expression levels over age

joined_table %>%
  filter(genename == "SFTPC") %>%
  filter(smoking_status != "unknown") %>%
  filter(normal_rnaseq == "yes") %>%
  group_by(normal_or_cancer, gender, smoking_status,
           cancer_stage, age_at_diagnosis) %>%
  summarise(mean_count = mean(counts_lengthscaledtpm)) %>%
  ggplot(aes(x = age_at_diagnosis,
             y = mean_count,
             color = smoking_status,
             shape = normal_or_cancer)) +
   xlab("Age at Diagnosis") +
  ylab("Mean Expression Level") +
  ggtitle("SFTPC Expression Level assosiate with Age, Gender and Smoking") +
  geom_point() +
   theme_bw() +
   geom_smooth(method = "lm",
              alpha = 0) +
  facet_grid(~ gender)
```


**Figure4**: SFTPC gene expression levels in different genders and its corrolation with age at diagnosis and smoking status. Age at diagnosis is the continuous variable and catagorized into gender and colored by smoking status, points are shaped by tissue types. Compare the SFTPC gene expression levels in male and female independently. Cancer tissues has SFTPC gene significanlty down regulated, than in normal tissue. Compare accross male and female cancer tissue samples, female has SFTPC expressed slighltly higher than males cancer tissues. In camparision of tissue types, female samples are dominated by never smokers with a few previous smokers' samples. Male samples are abundant in previous smokers and current smokers, with very small sample amout of never smokers. Thus, for female never smokers the SFTPC expression levels is not changed significaltly along with age at diagnosis. For male current smoker, SFTPC mean expression levels decrease significantly while age at diagnosis increases. For male previous smokers, age at diagnosis is does not influence the SFTPC expression levels. 




# Discussion
In conclusion, in the same individul lung cancer tissue has a significant lower SFTPC expression levels, which might lead to the significant loos e of lung cancers due to the lung collaposes. SFTPC is a vital gene for typeII alveola cells in the lung, whcih is also the main location of adenocarcinoa. And this loos of lung normal function will lead to a high death rate of lung cancer. 
In addition, smoking, especially current male smokers wil have more down regulated SFTPC gene expression levels in normal tissues along with increase of age at diagnosis. This provide one of the possible reasoning that adenocarcinoma is the most common type of NSCLC. The large smoking population with decreased SFTPC expression and typeII alveola will increase the chance of effected by adenocarcinoma NSCLC. Also, elder current smoking population are more vunerable to the adnocarcinoma NSCLC. 
What's more, for female somkers, SFTPC gene expression levels remain relativly constant along with the increase of age at diagnosis. Also, for male previsou smokers, the SFTPC expression level is not further down regulated as current smokers. Thus, stop smoking as soon as possible or stay away from smoking will be sufficient to increase the survival rate of lung cancer, specifically adenocarcinoma NSCLC. 

There are also several limitations of this paper. Firstly, the female samples are dominated by never smokers, thus we need more data and samples ti ensure the observation and conclusions reached in male samples can apply to female popultaions. Also, for male samples there is a very small amount of never smokers, thus, we need more samples to ensure that the conclusion we reached in females can apply to male never smokers. Secondly, SFTPC is highly expressed in type II alveolar cells [cite]. But from the sample metadata, there is no record of which type of cancer each patient has. Thus, have a more detailed metadata to indicate the subtypes of lung cancer will be more helpful to form a more in deepthed research. 

In summary, SFTPC gene is highly expressed in more lung typeII alveolar cells, which is significant to lung function. Lung cancer will significantly down regulate the express of SFTPC gene in all stages. Furhtermore, smoking, especially current smoking status will make patients more vunerable to lung cancer, and at older ages of diagnosis. Inorder to further down regulate the SFTPC gene expression, there might be some new pathway activated by compund in ciggrattes to down regulate the SFTPC gene expression directly or upregulate the regulatory factor od SFTPC gene expression. But this still remains in question, and needs further research and envidence. 
# Sources Cited
